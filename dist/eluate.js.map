{
  "version": 3,
  "sources": ["../src/core/createObjectProxy.js", "../src/core/features/text.js", "../src/core/features/event.js", "../src/core/features/show.js", "../src/core/features/model.js", "../src/core/initElement.js", "../src/core/initRoot.js", "../src/core/initRecursive.js", "../src/main.js"],
  "sourcesContent": ["function createObjectProxy(target = {}) {\n  // special properties used\n  const $specials = {\n    $text: [],\n    $show: [],\n    $model: [],\n    $get(prop) {\n      const setGlobal = Object.keys(target)\n        .map((k) => `globalThis.${k} = this.${k}`)\n        .join(';');\n      return new Function(`${setGlobal};\\nreturn ${prop}`).call(target);\n    },\n    $set(prop, value) {\n      // user JSON stringify to any value convert into string\n      let valueString = JSON.stringify(value);\n      new Function(`return this.${prop} = ${valueString}`).call(target);\n\n      // update the real DOM\n      // data-text\n      this.$text.forEach(({ element, value }) => {\n        element.innerHTML = proxy.$get(value);\n      });\n      // data-show\n      this.$show.forEach(({ element, value }) => {\n        element.style.display = proxy.$get(value) ? '' : 'none';\n      });\n      // data-model\n      this.$model.forEach(({ updateFn }) => {\n        updateFn();\n      });\n    },\n  };\n\n  const proxy = new Proxy(target, {\n    get(target, prop) {\n      if (prop.startsWith('$')) {\n        const $special = $specials[prop];\n        if (!$special) throw new Error(`unknown special property '${prop}'`);\n        return $special;\n      }\n\n      return $specials.$get(prop);\n    },\n    set(target, prop, value) {\n      if (prop.startsWith('$')) {\n        return \"can't set special property\";\n      }\n\n      $specials.$set(prop, value);\n    },\n  });\n  return proxy;\n}\n\nexport default createObjectProxy;\n", "function textImpl(element, value, proxy) {\n  proxy.$text.push({ element, value });\n  element.innerHTML = proxy.$get(value);\n}\n\nexport default textImpl;\n", "function eventImpl(eventName, element, value, proxy) {\n  // TODO: not reactive for nested objects and arrays\n  const eventHandler = new Function('$event', value).bind(proxy);\n  element.addEventListener(eventName, eventHandler);\n}\n\nexport default eventImpl;\n", "function showImpl(element, value, proxy) {\n  proxy.$show.push({ element, value });\n  element.style.display = proxy.$get(value) ? '' : 'none';\n}\n\nexport default showImpl;\n", "function modelImpl(element, value, proxy) {\n  // TODO: handle for other form types \n  const updateFn = function () {\n    element.value = proxy.$get(value);\n  };\n  proxy.$model.push({ updateFn });\n  updateFn();\n  element.addEventListener('input', (e) => {\n    proxy.$set(value, e.target.value);\n  });\n}\n\nexport default modelImpl;\n", "import textImpl from './features/text';\nimport eventImpl from './features/event';\nimport showImpl from './features/show';\nimport modelImpl from './features/model';\n\nfunction initElement(element, proxy) {\n  const vnode = {\n    proxy,\n    element,\n    children: [],\n  };\n\n  Object.entries(element.dataset).forEach(([name, value]) => {\n    if (name === 'text') {\n      textImpl(element, value, proxy);\n      delete element.dataset[name];\n    } else if (name.startsWith('on:')) {\n      const [, eventName] = name.split(':');\n      eventImpl(eventName, element, value, proxy);\n      delete element.dataset[name];\n    } else if (name === 'show') {\n      showImpl(element, value, proxy);\n      delete element.dataset[name];\n    } else if (name === 'model') {\n      modelImpl(element, value, proxy);\n      delete element.dataset[name];\n    } else if (name === 'set') {\n      throw new Error('`data-set` cannot be inside another `data-set`');\n    }\n  });\n  [...element.children].forEach((child) => {\n    const $childVDom = initElement(child, proxy);\n    vnode.children.push($childVDom);\n  });\n\n  return vnode;\n}\n\nexport default initElement;\n", "import createObjectProxy from './createObjectProxy';\nimport initElement from './initElement';\n\nfunction initRoot(element, value) {\n  if (value === '') value = '{}';\n  const dataObj = new Function(`return ${value};`)();\n  if (dataObj.constructor !== Object) {\n    throw new Error('`data-set` value must be an object');\n  }\n\n  const vroot = {\n    proxy: createObjectProxy(dataObj),\n    element,\n    children: [],\n  };\n\n  // create an object proxy to use in data binding\n  const proxy = createObjectProxy(dataObj);\n  [...element.children].forEach((child) => {\n    const vnode = initElement(child, proxy);\n    vroot.children.push(vnode);\n  });\n\n  return vroot;\n}\n\nexport default initRoot;\n", "import initRoot from './initRoot';\n\n// find element with 'data-set' to initialize the root element of the app\nfunction initRecursive(element) {\n  if (element.dataset['set']) {\n    initRoot(element, element.dataset['set']);\n  } else {\n    [...element.children].forEach((child) => {\n      initRecursive(child);\n    });\n  }\n  delete element.dataset['set'];\n}\n\nexport default initRecursive;\n", "import initRecursive from './core/initRecursive';\n\ninitRecursive(document.body);\n"],
  "mappings": "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",
  "names": []
}
